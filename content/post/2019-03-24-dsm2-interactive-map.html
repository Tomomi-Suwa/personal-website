---
title: "DSM2 interactive map"
author: "Travis Hinkelman"
draft: false
date: '2019-03-24'
editor_options:
  chunk_output_type: console
slug: dsm2-interactive-map
categories:
  - R
  - Shiny
tags:
  - DSM2
  - leaflet
---



<p>The <a href="http://baydeltaoffice.water.ca.gov/modeling/deltamodeling/models/dsm2/dsm2.cfm">Delta Simulation Model II (DSM2)</a> is a hydrodynamic model used for <a href="https://sacdeltaguide.atavist.com/">Sacramento-San Joaquin Delta</a> planning and management. When working with DSM2 output, I frequently need to look up the location of channels and nodes in the model. A map of all of the channels and nodes (and more) is provided with DSM2 as a <a href="/pdf/DSM2_Grid2.0.pdf">PDF file</a>, but that file is not easy to search.</p>
<p>Fortunately, I have access to <a href="https://github.com/fishsciences/dsm2-map/tree/master/shapefiles">shapefiles</a> of DSM2 channels and nodes.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> With the power of <a href="https://shiny.rstudio.com/">Shiny</a> and the <a href="https://rstudio.github.io/leaflet/">leaflet package</a>, it is relatively simple to build a web-based, interactive map of DSM2 channels and nodes (embedded below).<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<p>The app<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a> allows for panning, zooming, and clicking on the map to identify channel and node numbers. If you already know the channel or node number, then you can select the channel or node via dropdown menus with search boxes. Because most of the Delta is tidal, the app also indicates which node represents the upstream end of the channel (i.e., a positive value of flow in DSM2 output indicates that flow is moving through a channel from the upstream to the downstream end).</p>
<p>The main feature that is missing from this simple app is a point layer with DSM2 stations (e.g., RSAC155, RSAN112), which are common reference points for DSM2 output.</p>
<iframe width="725" height="800" scrolling="no" frameborder="no" src="https://fishsciences.shinyapps.io/dsm2-map/">
</iframe>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>The original source of those shapefiles is unknown to me.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Shiny app is hosted on <a href="https://fishsciences.shinyapps.io/dsm2-map/" class="uri">https://fishsciences.shinyapps.io/dsm2-map/</a> and code is available through <a href="https://github.com/fishsciences/dsm2-map">GitHub</a>.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>The code in the DSM2 map app is derived from this <a href="https://www.r-bloggers.com/r-shiny-leaflet-using-observers/">example</a>.<a href="#fnref3">↩</a></p></li>
</ol>
</div>
